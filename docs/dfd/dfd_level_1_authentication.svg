<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 450" width="950" height="450">
  <style>
    text { font-family: Arial, sans-serif; font-size: 14px; }
    .title { font-size: 24px; font-weight: bold; }
    .label { font-size: 11px; }
    .process { font-size: 12px; }
  </style>
  
  <!-- Title -->
  <text x="475" y="40" text-anchor="middle" class="title">LEVEL 1 AUTHENTICATION MODULE</text>
  
  <!-- USER Entity (Rectangle) -->
  <rect x="30" y="190" width="80" height="50" fill="none" stroke="black" stroke-width="2"/>
  <text x="70" y="220" text-anchor="middle">USER</text>
  
  <!-- Authentication Process (Main) -->
  <ellipse cx="200" cy="215" rx="60" ry="30" fill="none" stroke="black" stroke-width="1.5"/>
  <text x="200" y="210" text-anchor="middle" class="process">Authentication</text>
  <text x="200" y="225" text-anchor="middle" class="process">Module</text>
  
  <!-- Arrow from USER to Authentication -->
  <line x1="110" y1="215" x2="140" y2="215" stroke="black" stroke-width="1.5"/>
  <polygon points="140,215 133,210 133,220" fill="black"/>
  
  <!-- Sub-process 1: Register User -->
  <ellipse cx="400" cy="90" rx="70" ry="28" fill="none" stroke="black" stroke-width="1.5"/>
  <text x="400" y="85" text-anchor="middle" class="process">Register</text>
  <text x="400" y="100" text-anchor="middle" class="process">User</text>
  
  <!-- Sub-process 2: Login (Get Token) -->
  <ellipse cx="400" cy="170" rx="70" ry="28" fill="none" stroke="black" stroke-width="1.5"/>
  <text x="400" y="165" text-anchor="middle" class="process">Login</text>
  <text x="400" y="180" text-anchor="middle" class="process">(Get JWT Token)</text>
  
  <!-- Sub-process 3: Refresh Token -->
  <ellipse cx="400" cy="250" rx="70" ry="28" fill="none" stroke="black" stroke-width="1.5"/>
  <text x="400" y="245" text-anchor="middle" class="process">Refresh</text>
  <text x="400" y="260" text-anchor="middle" class="process">Token</text>
  
  <!-- Sub-process 4: Validate Token -->
  <ellipse cx="400" cy="330" rx="70" ry="28" fill="none" stroke="black" stroke-width="1.5"/>
  <text x="400" y="325" text-anchor="middle" class="process">Validate</text>
  <text x="400" y="340" text-anchor="middle" class="process">Token</text>
  
  <!-- Arrows from Authentication to sub-processes -->
  <line x1="255" y1="195" x2="330" y2="105" stroke="black" stroke-width="1"/>
  <polygon points="330,105 322,109 326,117" fill="black"/>
  
  <line x1="260" y1="210" x2="330" y2="170" stroke="black" stroke-width="1"/>
  <polygon points="330,170 322,167 324,177" fill="black"/>
  
  <line x1="260" y1="230" x2="330" y2="250" stroke="black" stroke-width="1"/>
  <polygon points="330,250 322,246 323,256" fill="black"/>
  
  <line x1="250" y1="240" x2="330" y2="325" stroke="black" stroke-width="1"/>
  <polygon points="330,325 323,318 320,327" fill="black"/>
  
  <!-- Data Store: users (right-open box) -->
  <line x1="600" y1="75" x2="700" y2="75" stroke="black" stroke-width="1.5"/>
  <line x1="600" y1="75" x2="600" y2="105" stroke="black" stroke-width="1.5"/>
  <line x1="600" y1="105" x2="700" y2="105" stroke="black" stroke-width="1.5"/>
  <text x="650" y="95" text-anchor="middle" class="label">users</text>
  
  <!-- Arrow from Register to users -->
  <line x1="470" y1="90" x2="600" y2="90" stroke="black" stroke-width="1.5"/>
  <polygon points="600,90 593,85 593,95" fill="black"/>
  <text x="535" y="80" text-anchor="middle" class="label">user_data</text>
  
  <!-- Arrow from Login to users (validate credentials) -->
  <line x1="470" y1="160" x2="550" y2="160" stroke="black" stroke-width="1"/>
  <line x1="550" y1="160" x2="550" y2="100" stroke="black" stroke-width="1"/>
  <line x1="550" y1="100" x2="600" y2="95" stroke="black" stroke-width="1"/>
  <polygon points="600,95 593,90 593,100" fill="black"/>
  <text x="505" y="150" text-anchor="middle" class="label">credentials</text>
  
  <!-- Data Store: jwt_tokens (right-open box) -->
  <line x1="600" y1="155" x2="710" y2="155" stroke="black" stroke-width="1.5"/>
  <line x1="600" y1="155" x2="600" y2="185" stroke="black" stroke-width="1.5"/>
  <line x1="600" y1="185" x2="710" y2="185" stroke="black" stroke-width="1.5"/>
  <text x="655" y="175" text-anchor="middle" class="label">jwt_tokens</text>
  
  <!-- Arrow from Login to jwt_tokens -->
  <line x1="470" y1="175" x2="600" y2="170" stroke="black" stroke-width="1.5"/>
  <polygon points="600,170 593,165 593,175" fill="black"/>
  <text x="535" y="190" text-anchor="middle" class="label">access_token</text>
  
  <!-- Data Store: refresh_tokens (right-open box) -->
  <line x1="600" y1="235" x2="730" y2="235" stroke="black" stroke-width="1.5"/>
  <line x1="600" y1="235" x2="600" y2="265" stroke="black" stroke-width="1.5"/>
  <line x1="600" y1="265" x2="730" y2="265" stroke="black" stroke-width="1.5"/>
  <text x="665" y="255" text-anchor="middle" class="label">refresh_tokens</text>
  
  <!-- Arrow from Refresh Token to refresh_tokens -->
  <line x1="470" y1="250" x2="600" y2="250" stroke="black" stroke-width="1.5"/>
  <polygon points="600,250 593,245 593,255" fill="black"/>
  <text x="535" y="240" text-anchor="middle" class="label">refresh_token</text>
  
  <!-- Arrow from Validate Token reading from jwt_tokens -->
  <line x1="470" y1="320" x2="580" y2="320" stroke="black" stroke-width="1"/>
  <line x1="580" y1="320" x2="580" y2="185" stroke="black" stroke-width="1"/>
  <line x1="580" y1="185" x2="600" y2="175" stroke="black" stroke-width="1"/>
  <polygon points="470,320 477,315 477,325" fill="black"/>
  <text x="530" y="335" text-anchor="middle" class="label">token_validation</text>
  
  <!-- Response back to USER -->
  <line x1="200" y1="245" x2="200" y2="380" stroke="black" stroke-width="1"/>
  <line x1="200" y1="380" x2="70" y2="380" stroke="black" stroke-width="1"/>
  <line x1="70" y1="380" x2="70" y2="240" stroke="black" stroke-width="1"/>
  <polygon points="70,240 65,247 75,247" fill="black"/>
  <text x="140" y="395" text-anchor="middle" class="label">auth_response</text>
</svg>
